
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.net.InetAddress;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.SocketException;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import javax.swing.JOptionPane;
import javax.swing.table.AbstractTableModel;
import javax.swing.table.TableModel;
import java.lang.Exception.*;
import java.util.Random;
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

/**
 *
 * @author Gurkanwal
 */
class clients{
    String name;
}
public class serverEDC extends javax.swing.JFrame {

    /**
     * Creates new form server
     */
    ArrayList<clients> connectors;
    TableModel tm;
    boolean admin_access=false;
    String[] countries = {"germany","russia","usa","uk","australia","china","france","kuwait","india"};
    public serverEDC() {
        tm = new TableModel();
        connectors = new ArrayList<>();
        initComponents();
        setTitle("EDC SERVER");
        jTextArea1.setVisible(false);
        jTextArea1.setEditable(false);
        jTextArea1.setFocusable(false);
        stopadminbutton.setEnabled(false);
        startadminbutton.setEnabled(false);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jButton1 = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTextArea1 = new javax.swing.JTextArea();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable1 = new javax.swing.JTable();
        jLabel2 = new javax.swing.JLabel();
        refreshbutton = new javax.swing.JButton();
        txtadminID = new javax.swing.JTextField();
        startadminbutton = new javax.swing.JButton();
        txtadminpass = new javax.swing.JPasswordField();
        stopadminbutton = new javax.swing.JButton();
        jLabel1 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jButton2 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jLabel4 = new javax.swing.JLabel();
        jButton4 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        jButton1.setText("START");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });

        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        jScrollPane1.setViewportView(jTextArea1);

        jTable1.setModel(tm);
        jScrollPane2.setViewportView(jTable1);

        jLabel2.setText("CONNECTORS");

        refreshbutton.setText("refresh");
        refreshbutton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                refreshbuttonActionPerformed(evt);
            }
        });

        startadminbutton.setText("START ADMIN ACCESS");
        startadminbutton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                startadminbuttonActionPerformed(evt);
            }
        });

        txtadminpass.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtadminpassActionPerformed(evt);
            }
        });

        stopadminbutton.setText("STOP ADMIN ACCESS");
        stopadminbutton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                stopadminbuttonActionPerformed(evt);
            }
        });

        jLabel1.setText("ADMIN ID");

        jLabel3.setText("ADMIN PASSWORD");

        jButton2.setText("DEMAND");
        jButton2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton2ActionPerformed(evt);
            }
        });

        jButton3.setText("RANDOM");
        jButton3.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton3ActionPerformed(evt);
            }
        });

        jLabel4.setText("MODIFY PRICES ON THE BASIS OF:");

        jButton4.setText("CALCULATE PROFITS");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addGap(29, 29, 29)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel1)
                            .addComponent(jLabel3))
                        .addGap(64, 64, 64)
                        .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(72, 72, 72)
                        .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 432, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(0, 0, Short.MAX_VALUE))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGap(154, 154, 154)
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                            .addComponent(txtadminID, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                                            .addComponent(txtadminpass, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                    .addGroup(layout.createSequentialGroup()
                                        .addContainerGap()
                                        .addComponent(jLabel4, javax.swing.GroupLayout.PREFERRED_SIZE, 281, javax.swing.GroupLayout.PREFERRED_SIZE)))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addContainerGap()
                                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                    .addGroup(layout.createSequentialGroup()
                                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                            .addComponent(jButton2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                            .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                        .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 167, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(layout.createSequentialGroup()
                                        .addGap(0, 0, Short.MAX_VALUE)
                                        .addComponent(startadminbutton)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(stopadminbutton)))
                                .addGap(73, 73, 73)))
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(refreshbutton)
                                .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 309, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(83, 83, 83)))))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGap(27, 27, 27)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jButton1, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 137, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(53, 53, 53)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel2)
                    .addComponent(txtadminID, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jLabel1))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jScrollPane2, javax.swing.GroupLayout.PREFERRED_SIZE, 268, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(refreshbutton))
                    .addGroup(layout.createSequentialGroup()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtadminpass, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel3))
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(startadminbutton, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(stopadminbutton, javax.swing.GroupLayout.PREFERRED_SIZE, 57, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(74, 74, 74)
                        .addComponent(jLabel4)
                        .addGap(18, 18, 18)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 46, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 87, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addContainerGap(51, Short.MAX_VALUE))
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        server obj = new server();
        Thread t1 = new Thread(obj);
        t1.start();
        System.out.println("server started at port 9001");
        jButton1.setEnabled(false);
        startadminbutton.setEnabled(true);
    }//GEN-LAST:event_jButton1ActionPerformed

    private void refreshbuttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_refreshbuttonActionPerformed
        tm.fireTableDataChanged();
    }//GEN-LAST:event_refreshbuttonActionPerformed

    private void startadminbuttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_startadminbuttonActionPerformed
        String user = txtadminID.getText();
        String pass = txtadminpass.getText();
        if(user.equals("gurkanwal")&&pass.equals("march21")){
            JOptionPane.showMessageDialog(rootPane,"ADMIN ACCESS PROVIDED");
            stopadminbutton.setEnabled(true);
            startadminbutton.setEnabled(false);
            admin_access=true;
        }
        else{
            JOptionPane.showMessageDialog(rootPane,"INCORRECT ADMIN ID/PASSWORD");
            admin_access=false;
        }
    }//GEN-LAST:event_startadminbuttonActionPerformed

    private void txtadminpassActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtadminpassActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtadminpassActionPerformed

    private void stopadminbuttonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_stopadminbuttonActionPerformed
        // TODO add your handling code here:
        stopadminbutton.setEnabled(false);
        startadminbutton.setEnabled(true);
        admin_access=false;
    }//GEN-LAST:event_stopadminbuttonActionPerformed

    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
        try {
            if(admin_access){
            String[] quantities = {"land_q","technology_q","chemical_q","machinery_q","oil_q","electricity_q","plastic_q","metal_q","labour_q"};
            String[] resources = {"land_p","technology_p","chemical_p","machinery_p","oil_p","electricity_p","plastic_p","metal_p","labour_p"};
            int[] new_resource_price = new int[9];
            String[] countries = new String[9];
            ArrayList<Object> a = new ArrayList<>();
            for(int i =0;i<9;i++){
                double factor = 1.2;
                for(int j =0; j<9;j++){
                    a.clear();
                    String get_stmt= "SELECT * FROM price ORDER BY "+quantities[i]+" DESC LIMIT "+j+" , "+(j+1);
                    ResultSet rs = SqlUtil.getData(get_stmt);
                    rs.next();
                    new_resource_price[j] = (int)(rs.getInt(resources[i])*factor);
                    countries[j] = rs.getString("country");
                    factor=factor-0.05;
//                    System.out.println(countries[j]+": "+new_resource_price[j]);
                    String send_stmt = "UPDATE price SET "+resources[i]+"=? WHERE country=?";
                    a.add(new_resource_price[j]);
                    a.add(countries[j]);
                    SqlUtil.ins_upd_del(send_stmt, a);
                }
//                System.out.println("-----------");
//                SELECT * FROM `price` ORDER BY `land_q` DESC LIMIT 0 , 30
            }
            JOptionPane.showMessageDialog(rootPane,"PRICES SUCCESSFULLY UPDATED ACCORDING TO DEMAND");
        }
        else{
            JOptionPane.showMessageDialog(rootPane,"FIRST LOG IN AS ADMIN");
        }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(rootPane,"CHANCES OF DATABASE CORRUPTION");
            e.printStackTrace();
        }
        catch (Exception e) {
            JOptionPane.showMessageDialog(rootPane,"DATABASE OK BUT SOMETHING's WRONG.");
            e.printStackTrace();
        }
    }//GEN-LAST:event_jButton2ActionPerformed

    private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
        // TODO add your handling code here:
        try {
            if(admin_access){
            String[] quantities = {"land_q","technology_q","chemical_q","machinery_q","oil_q","electricity_q","plastic_q","metal_q","labour_q"};
            String[] resources = {"land_p","technology_p","chemical_p","machinery_p","oil_p","electricity_p","plastic_p","metal_p","labour_p"};
            int[] new_resource_price = new int[9];
            String[] countries = new String[9];
            ArrayList<Object> a = new ArrayList<>();
            Random r = new Random();
            double low = 8;
            double high = 12;
            for(int i =0;i<9;i++){
                double factor = 0.0;
                for(int j =0; j<9;j++){
                    a.clear();
                    String get_stmt= "SELECT * FROM price ORDER BY "+quantities[i]+" DESC LIMIT "+j+" , "+(j+1);
                    ResultSet rs = SqlUtil.getData(get_stmt);
                    rs.next();
                    factor= (double)(r.nextInt(5)+8)/(double)10;
//                    System.out.println(factor);
                    new_resource_price[j] = (int)(rs.getInt(resources[i])*factor);
                    countries[j] = rs.getString("country");
//                    System.out.println(countries[j]+": "+new_resource_price[j]);
                    String send_stmt = "UPDATE price SET "+resources[i]+"=? WHERE country=?";
                    a.add(new_resource_price[j]);
                    a.add(countries[j]);
                    SqlUtil.ins_upd_del(send_stmt, a);
                }
//                System.out.println("-----------");
//                SELECT * FROM `price` ORDER BY `land_q` DESC LIMIT 0 , 30
            }
            JOptionPane.showMessageDialog(rootPane,"PRICES SUCCESSFULLY UPDATED RANDOMLY");
        }
        else{
            JOptionPane.showMessageDialog(rootPane,"FIRST LOG IN AS ADMIN");
        }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(rootPane,"CHANCES OF DATABASE CORRUPTION");
            e.printStackTrace();
        }
        catch (Exception e) {
            JOptionPane.showMessageDialog(rootPane,"DATABASE OK BUT SOMETHING's WRONG.");
            e.printStackTrace();
        }
    }//GEN-LAST:event_jButton3ActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
        try {
            if(admin_access){
                int rows = 0;
                ArrayList<Object> a = new ArrayList<>();
                String row_query = "SELECT COUNT(*) FROM teams";
                ResultSet r = SqlUtil.getData(row_query);
                r.next();
                rows = (r.getInt("COUNT(*)"));
                String[] products = {"jet","medicine","fmcg","defense","car","clothes","mobile","ships","money"}; 
                int[] SP = {771000,80400,100920,783000,211800,76500,64200,694800,1};
                int total_sp,profit,id=0 ;
                for(int i = 0;i<rows;i++ ){
                    a.clear();
                    total_sp=0;
                    profit=0;
                    String get_stmt= "SELECT * FROM teams LIMIT "+i+" , "+(i+1);
                    ResultSet rs = SqlUtil.getData(get_stmt);
                    rs.next();
                    id = rs.getInt("ID");
                    for(int j = 0;j<9;j++){
//                        System.out.println("TEAM "+i+"product +"+j+": "+rs.getInt(products[j]));
                        total_sp=total_sp+(rs.getInt(products[j])*SP[j]);
                        profit = total_sp-10000000;
                    }
                    String profit_stmt = "UPDATE teams SET value = ? WHERE ID = ?";
                    a.add(profit);
                    a.add(id);
                    SqlUtil.ins_upd_del(profit_stmt, a);
//                    System.out.println("TEAM "+id+" SP: "+profit+" ----------------");
                }
                JOptionPane.showMessageDialog(rootPane,"PROFITS CALCULATED SUCCESSFULLY");
            }
            else{
                JOptionPane.showMessageDialog(rootPane,"FIRST LOG IN AS ADMIN");
            }
        } catch (SQLException e) {
            JOptionPane.showMessageDialog(rootPane,"CHANCES OF DATABASE CORRUPTION");
            e.printStackTrace();
        }catch (Exception e) {
            e.printStackTrace();
        }
    }//GEN-LAST:event_jButton4ActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(serverEDC.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(serverEDC.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(serverEDC.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(serverEDC.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new serverEDC().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTable jTable1;
    private javax.swing.JTextArea jTextArea1;
    private javax.swing.JButton refreshbutton;
    private javax.swing.JButton startadminbutton;
    private javax.swing.JButton stopadminbutton;
    private javax.swing.JTextField txtadminID;
    private javax.swing.JPasswordField txtadminpass;
    // End of variables declaration//GEN-END:variables
    public class TableModel extends AbstractTableModel {
        
        String title[] = {"S.No.", "TYPE"};
        
        public String getColumnName(int a) {
            return title[a];
        }
        
        public int getRowCount() {
            int n = connectors.size();
            return n;
        }
        
        public int getColumnCount() {
            return 2;
        }
        
        public Object getValueAt(int i, int j) {
            clients temp = connectors.get(i);
            if (j == 0) {
                return i + 1;
            }
            if (j == 1) {
                return temp.name;
            }
            return 0;
        }
        
    }
    public class server implements Runnable {
        
        ServerSocket sock;
        Socket s;
        
        public void run() {
            try {
                sock = new ServerSocket(9001);
                jTextArea1.setVisible(true);
                InetAddress inet = InetAddress.getLocalHost();
                InetAddress[] ips = InetAddress.getAllByName(inet.getCanonicalHostName());
                if (ips != null) {
                    for (int i = 0; i < ips.length; i++) {
                        System.out.println(ips[i]);
                        jTextArea1.append("SERVER IP " +i+" : "+ips[i]+"\n");
                    }
                }
                while (true) {
                    s = sock.accept();
                    System.out.println("connection built at :" + s);
                    client_handler obj = new client_handler(s);
                    Thread t = new Thread(obj);
                    t.start();
//                    clients.add(obj);
//                    tm.fireTableDataChanged();
                }
            } catch (Exception e) {
                
                e.printStackTrace();
            }
            
        }
        
        class client_handler implements Runnable {
            
            DataOutputStream dos;
            DataInputStream dis;
            Socket current;
            int index;
            public client_handler(Socket s) {
                try {
                    current = s;
                    dis = new DataInputStream(s.getInputStream());
                    dos = new DataOutputStream(s.getOutputStream());
                    clients obj = new clients();
                    obj.name = dis.readLine();
                    connectors.add(obj);
                    index=connectors.size()-1;
                    tm.fireTableDataChanged();
                    } catch (Exception ex) {
                    ex.printStackTrace();
                }
            }
            
            public void run() {
                try {
                    while (true) {
                        String str = dis.readLine();
                        System.out.println(str);
                        if(str.equals("COUNTRIES")){
                            System.out.println("countries price list requested");
                            dos.writeBytes("OKD\r\n");
                            for(int i =0;i<9;i++){
                                String stmt = "select * from price where country='"+countries[i]+"'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                dos.writeBytes(countries[i]+"\r\n");
                                dos.writeBytes(s.getString("land_p")+"\r\n");
                                dos.writeBytes(s.getString("technology_p")+"\r\n");
                                dos.writeBytes(s.getString("chemical_p")+"\r\n");
                                dos.writeBytes(s.getString("machinery_p")+"\r\n");
                                dos.writeBytes(s.getString("oil_p")+"\r\n");
                                dos.writeBytes(s.getString("electricity_p")+"\r\n");
                                dos.writeBytes(s.getString("plastic_p")+"\r\n");
                                dos.writeBytes(s.getString("metal_p")+"\r\n");
                                dos.writeBytes(s.getString("labour_p")+"\r\n");
                            }
                        }
                        if(str.equals("INDIA DISTRIBUTION")){
                            System.out.println("distribution requested from india");
                            dos.writeBytes("INDIA GRANTED\r\n");
                            String stmt = "select * from price where country='india'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("INDIA")) {
                            System.out.println("INDIA CONNECTED");
                            dos.writeBytes("OKI\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='india'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("india_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("india");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("IC\r\n");
                        }
                        if(str.equals("GERMANY DISTRIBUTION")){
                            System.out.println("distribution requested from germany");
                            dos.writeBytes("GERMANY GRANTED\r\n");
                            String stmt = "select * from price where country='germany'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("GERMANY")) {
                            System.out.println("GERMANY CONNECTED");
                            dos.writeBytes("OKG\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='germany'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("germany_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("germany");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("GC\r\n");
                        }

                        if(str.equals("AUSTRALIA DISTRIBUTION")){
                            System.out.println("distribution requested from australia");
                            dos.writeBytes("AUSTRALIA GRANTED\r\n");
                            String stmt = "select * from price where country='australia'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("AUSTRALIA")) {
                            System.out.println("AUSTRALIA CONNECTED");
                            dos.writeBytes("OKA\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='australia'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("australia_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("australia");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("AC\r\n");
                        }
                        if(str.equals("RUSSIA DISTRIBUTION")){
                            System.out.println("distribution requested from russia");
                            dos.writeBytes("RUSSIA GRANTED\r\n");
                            String stmt = "select * from price where country='russia'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("RUSSIA")) {
                            System.out.println("RUSSIA CONNECTED");
                            dos.writeBytes("OKR\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='russia'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("russia_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("russia");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("RC\r\n");
                        }
                        if(str.equals("USA DISTRIBUTION")){
                            System.out.println("distribution requested from usa");
                            dos.writeBytes("USA GRANTED\r\n");
                            String stmt = "select * from price where country='usa'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("USA")) {
                            System.out.println("USA CONNECTED");
                            dos.writeBytes("OKUSA\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='usa'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("usa_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("usa");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("USAC\r\n");
                        }

                        if(str.equals("UK DISTRIBUTION")){
                            System.out.println("distribution requested from uk");
                            dos.writeBytes("UK GRANTED\r\n");
                            String stmt = "select * from price where country='uk'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("UK")) {
                            System.out.println("UK CONNECTED");
                            dos.writeBytes("OKUK\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='uk'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("uk_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("uk");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("UKC\r\n");
                        }
                        if(str.equals("CHINA DISTRIBUTION")){
                            System.out.println("distribution requested from china");
                            dos.writeBytes("CHINA GRANTED\r\n");
                            String stmt = "select * from price where country='china'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if(str.equals("FRANCE DISTRIBUTION")){
                            System.out.println("distribution requested from france");
                            dos.writeBytes("FRANCE GRANTED\r\n");
                            String stmt = "select * from price where country='france'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("FRANCE")) {
                            System.out.println("FRANCE CONNECTED");
                            dos.writeBytes("OKF\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='france'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("france_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("france");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("FC\r\n");
                        }
                        if(str.equals("KUWAIT DISTRIBUTION")){
                            System.out.println("distribution requested from kuwait");
                            dos.writeBytes("KUWAIT GRANTED\r\n");
                            String stmt = "select * from price where country='kuwait'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    dos.writeBytes(pold_land+"\r\n");
                                    dos.writeBytes(pold_technology+"\r\n");
                                    dos.writeBytes(pold_chemical+"\r\n");
                                    dos.writeBytes(pold_machinery+"\r\n");
                                    dos.writeBytes(pold_oil+"\r\n");
                                    dos.writeBytes(pold_electricity+"\r\n");
                                    dos.writeBytes(pold_plastic+"\r\n");
                                    dos.writeBytes(pold_metal+"\r\n");
                                    dos.writeBytes(pold_labour+"\r\n");
                                    dos.writeBytes("done\r\n");
                        }
                        if (str.equals("KUWAIT")) {
                            System.out.println("KUWAIT CONNECTED");
                            dos.writeBytes("OKK\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
//                            flag negative = false;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='kuwait'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("kuwait_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("kuwait");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("KC\r\n");
                        }

                        if (str.equals("CHINA")) {
                            System.out.println("CHINA CONNECTED");
                            dos.writeBytes("OKC\r\n");
                            String update_team,update_price;
                            ArrayList<Object> a,b ;
                            int money_remaining;
                            try {
//                                String[] resources={"land","technology","chemical","machinery","oil","electricity","plastic","metal","labour"};
                                int ID = Integer.parseInt(dis.readLine());
                                int land = Integer.parseInt(dis.readLine());
                                int technology = Integer.parseInt(dis.readLine());
                                int chemical = Integer.parseInt(dis.readLine());
                                int machinery = Integer.parseInt(dis.readLine());
                                int oil = Integer.parseInt(dis.readLine());
                                int electricity = Integer.parseInt(dis.readLine());
                                int plastic = Integer.parseInt(dis.readLine());
                                int metal = Integer.parseInt(dis.readLine());
                                int labour = Integer.parseInt(dis.readLine());
                                if(land<0||technology<0||chemical<0||machinery<0||oil<0||electricity<0||plastic<0||metal<0||labour<0){
                                    dos.writeBytes("FORMAT\r\n");
                                    continue;
                                }
                                String query = "SELECT * FROM teams where ID="+ID;
                                ResultSet r = SqlUtil.getData(query);
                                r.next();
                                int old_money,old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                
                                    old_land=(r.getInt("land"));
                                    old_technology=(r.getInt("technology"));
                                    old_chemical=(r.getInt("chemical"));
                                    old_machinery=(r.getInt("machinery"));
                                    old_oil=(r.getInt("oil"));
                                    old_electricity=(r.getInt("electricity"));
                                    old_plastic=(r.getInt("plastic"));
                                    old_metal=(r.getInt("metal"));
                                    old_labour=(r.getInt("labour"));
                                    old_money = r.getInt("money");
                                String stmt = "select * from price where country='china'";
                                ResultSet s = SqlUtil.getData(stmt);
                                s.next();
                                int qold_land,qold_technology,qold_chemical,qold_machinery,qold_oil,qold_electricity,qold_plastic,qold_metal,qold_labour;
                                int pold_land,pold_technology,pold_chemical,pold_machinery,pold_oil,pold_electricity,pold_plastic,pold_metal,pold_labour;
                                    qold_land=(s.getInt("land_q"));
                                    qold_technology=(s.getInt("technology_q"));
                                    qold_chemical=(s.getInt("chemical_q"));
                                    qold_machinery=(s.getInt("machinery_q"));
                                    qold_oil=(s.getInt("oil_q"));
                                    qold_electricity=(s.getInt("electricity_q"));
                                    qold_plastic=(s.getInt("plastic_q"));
                                    qold_metal=(s.getInt("metal_q"));
                                    qold_labour=(s.getInt("labour_q"));
                                    pold_land=(s.getInt("land_p"));
                                    pold_technology=(s.getInt("technology_p"));
                                    pold_chemical=(s.getInt("chemical_p"));
                                    pold_machinery=(s.getInt("machinery_p"));
                                    pold_oil=(s.getInt("oil_p"));
                                    pold_electricity=(s.getInt("electricity_p"));
                                    pold_plastic=(s.getInt("plastic_p"));
                                    pold_metal=(s.getInt("metal_p"));
                                    pold_labour=(s.getInt("labour_p"));
                                    int cost = (land*pold_land)+(technology*pold_technology)+(chemical*pold_chemical)+(machinery*pold_machinery)+(oil*pold_oil)+(electricity*pold_electricity)+(plastic*pold_plastic)+(metal*pold_metal)+(labour*pold_labour);
                                    System.out.println("cost: "+cost);
                                    money_remaining=old_money-cost;
//                                for(int i=0;i<resources.length;i++){
//                                    String stmt="SELECT * FROM prices where resource="+resources[i];
//                                    ResultSet s = SqlUtil.getData(stmt);
//                                    s.next();
//                                    int old_quantity = s.getInt("china_q");
//                                    int new_quantity = 
//                                }
                                update_team = "UPDATE teams SET land = ?, technology=?, chemical=?,machinery=?, oil=?, electricity=?, plastic=?,metal=?, labour=?, money=? WHERE ID=?";
                                a= new ArrayList<>();
                                a.add(land+old_land);
                                a.add(technology+old_technology);
                                a.add(chemical+old_chemical);
                                a.add(machinery+old_machinery);
                                a.add(oil+old_oil);
                                a.add(electricity+old_electricity);
                                a.add(plastic+old_plastic);
                                a.add(metal+old_metal);
                                a.add(labour+old_labour);
                                a.add(money_remaining);
                                a.add(ID);
                                System.out.println(update_team);
                                update_price = "UPDATE price SET land_q = ?, technology_q=?, chemical_q=?,machinery_q=?, oil_q=?, electricity_q=?, plastic_q=?,metal_q=?, labour_q=? WHERE country=?";
                                b = new ArrayList<>();
                                b.add(land+qold_land);
                                b.add(technology+qold_technology);
                                b.add(chemical+qold_chemical);
                                b.add(machinery+qold_machinery);
                                b.add(oil+qold_oil);
                                b.add(electricity+qold_electricity);
                                b.add(plastic+qold_plastic);
                                b.add(metal+qold_metal);
                                b.add(labour+qold_labour);
                                b.add("china");
                            } catch (NumberFormatException e) {
//                                JOptionPane.showMessageDialog(rootPane,"Enter values correctly. Only numbers are allowed in fields");
                                dos.writeBytes("FORMAT\r\n");
                                e.printStackTrace();
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                e.printStackTrace();
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            if(money_remaining<0){
                                dos.writeBytes("FUNDS\r\n");
                                continue;
                            }
                            SqlUtil.ins_upd_del(update_team, a);
                            SqlUtil.ins_upd_del(update_price, b);
                            dos.writeBytes("CC\r\n");
                        }
                        
                        if(str.equals("WORKSHOP")){
                            System.out.println("WORKSHOP CONNECTED");
                            dos.writeBytes("OKW\r\n");
                            try {
                                int id = Integer.parseInt(dis.readLine());
                                String query = "Select * from teams where ID="+id;
                                ResultSet rs = SqlUtil.getData(query);
                                rs.next();
                                int current_money=rs.getInt("money");
                                int old_land,old_technology,old_chemical,old_machinery,old_oil,old_electricity,old_plastic,old_metal,old_labour;
                                int old_jet,old_medicine,old_fmcg,old_defense,old_car,old_clothes,old_mobile,old_ships;    
                                old_land= rs.getInt("land");
                                old_technology=(rs.getInt("technology"));
                                old_chemical=(rs.getInt("chemical"));
                                old_machinery=(rs.getInt("machinery"));
                                old_oil=(rs.getInt("oil"));
                                old_electricity=(rs.getInt("electricity"));
                                old_plastic=(rs.getInt("plastic"));
                                old_metal=(rs.getInt("metal"));
                                old_labour=(rs.getInt("labour"));
                                old_jet=(rs.getInt("jet"));
                                old_medicine=(rs.getInt("medicine"));
                                old_fmcg=(rs.getInt("fmcg"));
                                old_defense=(rs.getInt("defense"));
                                old_car=(rs.getInt("car"));
                                old_clothes= (rs.getInt("clothes"));
                                old_mobile=(rs.getInt("mobile"));
                                old_ships=(rs.getInt("ships"));
                                int jet_purchased,medicine_purchased,fmcg_purchased,defense_purchased,car_purchased,clothes_purchased,mobile_purchased,ships_purchased;
                                jet_purchased=Integer.parseInt(dis.readLine());
                                medicine_purchased=Integer.parseInt(dis.readLine());
                                fmcg_purchased=Integer.parseInt(dis.readLine());
                                defense_purchased=Integer.parseInt(dis.readLine());
                                car_purchased=Integer.parseInt(dis.readLine());
                                clothes_purchased=Integer.parseInt(dis.readLine());
                                mobile_purchased=Integer.parseInt(dis.readLine());
                                ships_purchased=Integer.parseInt(dis.readLine());
                                
                                for(int i =jet_purchased;i>0;i--){
                                    old_land=old_land-50;
                                    old_technology=old_technology-300;
                                    old_chemical=old_chemical-0;
                                    old_machinery=old_machinery-100;
                                    old_oil=old_oil-150;
                                    old_electricity=old_electricity-50;
                                    old_plastic=old_plastic-0;
                                    old_metal=old_metal-200;
                                    old_labour=old_labour-500;
                                }
                                for(int i =medicine_purchased;i>0;i--){
                                    old_land=old_land-5;
                                    old_technology=old_technology-10;
                                    old_chemical=old_chemical-50;
                                    old_machinery=old_machinery-10;
                                    old_oil=old_oil-0;
                                    old_electricity=old_electricity-5;
                                    old_plastic=old_plastic-5;
                                    old_metal=old_metal-0;
                                    old_labour=old_labour-20;
                                }
                                for(int i =fmcg_purchased;i>0;i--){
                                    old_land=old_land-10;
                                    old_technology=old_technology-0;
                                    old_chemical=old_chemical-50;
                                    old_machinery=old_machinery-0;
                                    old_oil=old_oil-10;
                                    old_electricity=old_electricity-10;
                                    old_plastic=old_plastic-20;
                                    old_metal=old_metal-0;
                                    old_labour=old_labour-12;
                                }
                                for(int i =defense_purchased;i>0;i--){
                                    old_land=old_land-30;
                                    old_technology=old_technology-200;
                                    old_chemical=old_chemical-300;
                                    old_machinery=old_machinery-100;
                                    old_oil=old_oil-50;
                                    old_electricity=old_electricity-0;
                                    old_plastic=old_plastic-0;
                                    old_metal=old_metal-300;
                                    old_labour=old_labour-200;
                                }
                                for(int i =car_purchased;i>0;i--){
                                    old_land=old_land-10;
                                    old_technology=old_technology-50;
                                    old_chemical=old_chemical-0;
                                    old_machinery=old_machinery-50;
                                    old_oil=old_oil-50;
                                    old_electricity=old_electricity-20;
                                    old_plastic=old_plastic-50;
                                    old_metal=old_metal-40;
                                    old_labour=old_labour-200;
                                }
                                for(int i =clothes_purchased;i>0;i--){
                                    old_land=old_land-5;
                                    old_technology=old_technology-0;
                                    old_chemical=old_chemical-50;
                                    old_machinery=old_machinery-10;
                                    old_oil=old_oil-5;
                                    old_electricity=old_electricity-0;
                                    old_plastic=old_plastic-0;
                                    old_metal=old_metal-0;
                                    old_labour=old_labour-50;
                                }
                                for(int i =mobile_purchased;i>0;i--){
                                    old_land=old_land-5;
                                    old_technology=old_technology-10;
                                    old_chemical=old_chemical-0;
                                    old_machinery=old_machinery-5;
                                    old_oil=old_oil-0;
                                    old_electricity=old_electricity-10;
                                    old_plastic=old_plastic-50;
                                    old_metal=old_metal-10;
                                    old_labour=old_labour-50;
                                }
                                for(int i =ships_purchased;i>0;i--){
                                    old_land=old_land-20;
                                    old_technology=old_technology-200;
                                    old_chemical=old_chemical-0;
                                    old_machinery=old_machinery-200;
                                    old_oil=old_oil-100;
                                    old_electricity=old_electricity-20;
                                    old_plastic=old_plastic-0;
                                    old_metal=old_metal-300;
                                    old_labour=old_labour-400;
                                }
                                System.out.println("RESOURCES:  "+old_land+" "+old_technology+" "+old_chemical+" "+old_machinery+" "+old_oil+" "+old_electricity+" "+old_plastic+" "+old_metal+" "+old_labour);
//                                System.out.println("PRODUCTS:  "++" "+old_technology+" "+old_chemical+" "+old_machinery+" "+old_oil+" "+old_electricity+" "+old_plastic+" "+old_metal+" "+old_labour);
                                if(old_land>=0&&old_technology>=0&&old_chemical>=0&&old_machinery>=0&&old_oil>=0&&old_electricity>=0&&old_plastic>=0&&old_metal>=0&&old_labour>=0){
                                    old_jet=old_jet+jet_purchased;
                                    old_medicine=old_medicine+medicine_purchased;
                                    old_fmcg=old_fmcg+fmcg_purchased;
                                    old_defense=old_defense+defense_purchased;
                                    old_car=old_car+car_purchased;
                                    old_clothes=old_clothes+clothes_purchased;
                                    old_mobile=old_mobile+mobile_purchased;
                                    old_ships=old_ships+ships_purchased;
                                    String update_team = "UPDATE teams SET land = ?, technology=?, chemical=?, machinery=?, oil=?, electricity=?, plastic=?, metal=?, labour=?, jet=?, medicine=?, fmcg=?, defense=? , car=?, clothes=?, mobile=? , ships=? WHERE ID=?";
                                    ArrayList<Object> a= new ArrayList<>();
                                    a.add(old_land);
                                    a.add(old_technology);
                                    a.add(old_chemical);
                                    a.add(old_machinery);
                                    a.add(old_oil);
                                    a.add(old_electricity);
                                    a.add(old_plastic);
                                    a.add(old_metal);
                                    a.add(old_labour);
                                    a.add(old_jet);
                                    a.add(old_medicine);
                                    a.add(old_fmcg);
                                    a.add(old_defense);
                                    a.add(old_car);
                                    a.add(old_clothes);
                                    a.add(old_mobile);
                                    a.add(old_ships);
                                    a.add(id);
                                    System.out.println(update_team);
                                    SqlUtil.ins_upd_del(update_team, a);
                                    dos.writeBytes("done\r\n");
                                }
                                else{
                                    dos.writeBytes("LACK\r\n");
                                    continue;
                                }
                            } catch (NumberFormatException e) {
                                dos.writeBytes("FORMAT\r\n");
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                            
                        }
                        if(str.equals("VIEWER")){
                            System.out.println("VIEWER CONNECTED");
                            dos.writeBytes("OKV\r\n");
                            try {
                                int id = Integer.parseInt(dis.readLine());
                                String query = "Select * from teams where ID="+id;
                                ResultSet rs = SqlUtil.getData(query);
                                rs.next();
                                int current_money=rs.getInt("money");
                                int left_money=current_money-30000;
                                if(left_money>0){
                                dos.writeBytes("OK\r\n");
                                dos.writeBytes(rs.getString("ID")+"\r\n");
                                dos.writeBytes(rs.getString("member1")+"\r\n");
                                dos.writeBytes(rs.getString("member2")+"\r\n");
                                dos.writeBytes(rs.getString("land")+"\r\n");
                                dos.writeBytes(rs.getString("technology")+"\r\n");
                                dos.writeBytes(rs.getString("chemical")+"\r\n");
                                dos.writeBytes(rs.getString("machinery")+"\r\n");
                                dos.writeBytes(rs.getString("oil")+"\r\n");
                                dos.writeBytes(rs.getString("electricity")+"\r\n");
                                dos.writeBytes(rs.getString("plastic")+"\r\n");
                                dos.writeBytes(rs.getString("metal")+"\r\n");
                                dos.writeBytes(rs.getString("labour")+"\r\n");
                                dos.writeBytes(rs.getString("jet")+"\r\n");
                                dos.writeBytes(rs.getString("medicine")+"\r\n");
                                dos.writeBytes(rs.getString("fmcg")+"\r\n");
                                dos.writeBytes(rs.getString("defense")+"\r\n");
                                dos.writeBytes(rs.getString("car")+"\r\n");
                                dos.writeBytes(rs.getString("clothes")+"\r\n");
                                dos.writeBytes(rs.getString("mobile")+"\r\n");
                                dos.writeBytes(rs.getString("ships")+"\r\n");
                                dos.writeBytes((rs.getInt("money")-30000)+"\r\n");
                                
                                String update_team = "UPDATE teams SET money=? WHERE ID=?";
                                ArrayList<Object> a = new ArrayList<>();
                                    a.add(left_money);
                                    a.add(id);
                                SqlUtil.ins_upd_del(update_team, a);
                                dos.writeBytes("done"+"\r\n");
                                }
                                else{
                                    dos.writeBytes("FUNDS\r\n");
                                    continue;
                                }
                            } catch (NumberFormatException e) {
                                dos.writeBytes("FORMAT\r\n");
                                continue;
                            }
                            catch(SQLException e){
                                dos.writeBytes("IID\r\n");
                                continue;
                            }
                            catch(Exception e){
                                dos.writeBytes("ERROR\r\n");
                                continue;
                            }
                        }
                        if(str.equals("REGISTRAR")){
                            System.out.println("REGISTRAR CONNECTED");
                            dos.writeBytes("OKR\r\n");
                            String member1 = dis.readLine();
                            String member2 = dis.readLine();
                            String phone1 = dis.readLine();
                            String phone2 = dis.readLine();
                            String email1 = dis.readLine();
                            String email2 = dis.readLine();
                            String college = dis.readLine();
                            String insert_team = "INSERT INTO teams(member1,member2,phone1,phone2,email1,email2,college,money) VALUES (?,?,?,?,?,?,?,?)";                  //System.out.println(insert_team);
                            ArrayList<Object> a = new ArrayList<>();
                            a.add(member1);
                            a.add(member2);
                            a.add(phone1);
                            a.add(phone2);
                            a.add(email1);
                            a.add(email2);
                            a.add(college);
                            a.add(10000000);
                            SqlUtil.ins_upd_del(insert_team, a);
                            String ids = "select * from teams";
                            ResultSet i = SqlUtil.getData(ids);
                            i.last();
                            String id = i.getString("ID");
                            dos.writeBytes("RC\r\n");
                            dos.writeBytes(id+"\r\n");
                        }
                    }
                } 
                catch (Exception e) {
                    connectors.get(index).name="------------";
                    tm.fireTableDataChanged();
                    e.printStackTrace();
                            
//                    clients.remove(this);
//                    tm.fireTableDataChanged();
                }
            }
        }
    }
}
